### [CVE-2021-3493](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493)
![](https://img.shields.io/static/v1?label=Product&message=linux%20kernel&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=5.8%20kernel%3C%205.8.0-50.56%20%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-270%3A%20Privilege%20Context%20Switching%20Error&color=brighgreen)

### Description

The overlayfs implementation in the linux kernel did not properly validate with respect to user namespaces the setting of file capabilities on files in an underlying file system. Due to the combination of unprivileged user namespaces along with a patch carried in the Ubuntu kernel to allow unprivileged overlay mounts, an attacker could use this to gain elevated privileges.

### POC

#### Reference
- http://packetstormsecurity.com/files/162434/Kernel-Live-Patch-Security-Notice-LSN-0076-1.html
- http://packetstormsecurity.com/files/162866/Ubuntu-OverlayFS-Local-Privilege-Escalation.html
- http://packetstormsecurity.com/files/165151/Ubuntu-Overlayfs-Local-Privilege-Escalation.html

#### Github
- https://github.com/briskets/CVE-2021-3493
- https://github.com/inspiringz/CVE-2021-3493
- https://github.com/oneoy/CVE-2021-3493
- https://github.com/AmIAHuman/OverlayFS-CVE-2021-3493
- https://github.com/Ishan3011/CVE-2021-3493
- https://github.com/derek-turing/CVE-2021-3493
- https://github.com/Ishan3011/CVE-2021-3493
- https://github.com/Abdennour-py/CVE-2021-3493

